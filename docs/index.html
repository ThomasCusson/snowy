
<!DOCTYPE html>

<head>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-19914519-2">
</script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-19914519-2');
</script>
<title>Snowy</title>
<link href="snowflake64.png" rel="icon" type="image/x-icon"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta charset="utf-8"/>
<meta content="https://prideout.net/snowy/snowy2.png" property="og:image"/>
<meta content="GitHub" property="og:site_name"/>
<meta content="object" property="og:type"/>
<meta content="prideout/snowy" property="og:title"/>
<meta content="https://prideout.net/snowy/" property="og:url"/>
<meta content="Small Python 3 module for manipulating and generating images." property="og:description"/>
<link href="https://fonts.googleapis.com/css?family=Alegreya" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet"/>
<style>
body {
    margin: 0;
    font-size: 15px;
    font-family: "Avenir Next", "HelveticaNeue", "Helvetica Neue",
        Helvetica, Arial, "Lucida Grande", sans-serif;
    text-rendering: optimizeLegibility;
    font-weight: 400;
    -webkit-font-smoothing:auto;
    background-color: #e2e2e2;
}
a {
    text-decoration: none;
    color: #2962ad;
}
hr {
     border: 0;
    border-bottom: 1px dashed #ccc;
    background: #999;
}
small, small a {
    color: #a0a0a0;
    margin-top: 26px;
}
td:first-child {
    padding-right: 15px;
}
p:first-child {
    clear: left;
}
h1 {
    margin-top: 0;
    margin-bottom: 0;
    font-family: 'Alegreya', serif;
    font-size: 45px;
}
main {
    overflow: auto;
    margin: 0 auto;
    padding: 0 80px 20px 80px;
    max-width: 800px;
    background-color: #ffffff;
    position: relative;
    color: #404040;
    border-left: solid 2px black;
    border-right: solid 2px black;
}
@media (max-width: 960px){
    body{ background-color: #f2f2f2; }
    main{ padding: 0 20px 100px 20px; }
}
img {
    max-width: 100%;
}
pre {
    padding: 10px;
    background-color: #f8f8f8;
    white-space: pre-wrap;
    font-family: 'Inconsolata', monospace;
}
code {
    font-family: 'Inconsolata', monospace;
}
p.aside {
    background: white;
    font-size: small;
    border: solid 1px gray;
    border-left: solid 5px gray;
    padding: 10px;
}
h2 a, h3 a, h4 a { color: black }
h2 a:hover, h3 a:hover, h4 a:hover { color: #19529d }
</style>
<style>.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #8f5902; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #ef2929 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #204a87; font-weight: bold } /* Keyword */
.highlight .l { color: #000000 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #ce5c00; font-weight: bold } /* Operator */
.highlight .x { color: #000000 } /* Other */
.highlight .p { color: #000000; font-weight: bold } /* Punctuation */
.highlight .ch { color: #8f5902; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #8f5902; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #8f5902; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #8f5902; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #8f5902; font-style: italic } /* Comment.Single */
.highlight .cs { color: #8f5902; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #ef2929 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #a40000; font-weight: bold } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #204a87; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #204a87; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #204a87; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #204a87; font-weight: bold } /* Keyword.Type */
.highlight .ld { color: #000000 } /* Literal.Date */
.highlight .m { color: #0000cf; font-weight: bold } /* Literal.Number */
.highlight .s { color: #4e9a06 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #204a87 } /* Name.Builtin */
.highlight .nc { color: #000000 } /* Name.Class */
.highlight .no { color: #000000 } /* Name.Constant */
.highlight .nd { color: #5c35cc; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #ce5c00 } /* Name.Entity */
.highlight .ne { color: #cc0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #000000 } /* Name.Function */
.highlight .nl { color: #f57900 } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #204a87; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #000000 } /* Name.Variable */
.highlight .ow { color: #204a87; font-weight: bold } /* Operator.Word */
.highlight .w { color: #f8f8f8; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #0000cf; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #0000cf; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #0000cf; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000cf; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #0000cf; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { color: #4e9a06 } /* Literal.String.Affix */
.highlight .sb { color: #4e9a06 } /* Literal.String.Backtick */
.highlight .sc { color: #4e9a06 } /* Literal.String.Char */
.highlight .dl { color: #4e9a06 } /* Literal.String.Delimiter */
.highlight .sd { color: #8f5902; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4e9a06 } /* Literal.String.Double */
.highlight .se { color: #4e9a06 } /* Literal.String.Escape */
.highlight .sh { color: #4e9a06 } /* Literal.String.Heredoc */
.highlight .si { color: #4e9a06 } /* Literal.String.Interpol */
.highlight .sx { color: #4e9a06 } /* Literal.String.Other */
.highlight .sr { color: #4e9a06 } /* Literal.String.Regex */
.highlight .s1 { color: #4e9a06 } /* Literal.String.Single */
.highlight .ss { color: #4e9a06 } /* Literal.String.Symbol */
.highlight .bp { color: #3465a4 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #000000 } /* Name.Function.Magic */
.highlight .vc { color: #000000 } /* Name.Variable.Class */
.highlight .vg { color: #000000 } /* Name.Variable.Global */
.highlight .vi { color: #000000 } /* Name.Variable.Instance */
.highlight .vm { color: #000000 } /* Name.Variable.Magic */
.highlight .il { color: #0000cf; font-weight: bold } /* Literal.Number.Integer.Long */
    .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi,
    .highlight .mo { color: #0063cf; }
    </style><main>
<!-- GITHUB FORK ME LOGO -->
<a aria-label="View source on Github" class="github-corner" href="https://github.com/prideout/snowy">
<svg aria-hidden="true" height="80" style="color:#fff; position: absolute; top: 0; border: 0;
right: 0;" viewbox="0 0 250 250" width="80"> <path d="M0,0 L115,115 L130,115 L142,142
L250,250 L250,0 Z"></path> <path class="octo-arm" d="M128.3,109.0 C113.8,99.7 119.0,89.6
119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3
123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9
134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;"></path><path class="octo-body" d="M115.0,115.0 C114.9,115.1 118.7,116.5
119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0
127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4
163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6
187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2
216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4
203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1
C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7
141.6,141.9 141.8,141.8 Z" fill="currentColor"></path></svg></a>
<style>.github-corner:hover svg { fill: #19529d }</style>
<small>v0.0.6 ~ <a href="https://github.com/prideout/snowy/tree/3ebc0a7">3ebc0a7</a></small>
<h1>Snowy <img height="64px" src="snowy2.png" style="vertical-align:text-bottom;margin-left:10px"/></h1>
<p><strong>User's Guide</strong> | <a href="reference.html">API Reference</a></p>
<p>Snowy is a tiny module for manipulating and generating floating-point images.</p>
<ul>
<li>Small and flat API (free functions only).</li>
<li>Written purely in Python 3.</li>
<li>Accelerated with <a href="https://numba.pydata.org/">numba</a>.</li>
<li>Configurable boundaries (<a href="#wrap_modes">wrap modes</a>).</li>
</ul>
<p>Snowy does not define a special class for images. Instead, <strong>images are always three-dimensional
numpy arrays</strong> in row-major order.</p>
<p class="aside">For example, RGB images have shape <code>[height,width,3]</code> and grayscale images have shape
<code>[height,width,1]</code>. Snowy provides some utility functions that make it easy to work with other
modules (see <a href="#interop">interop</a>).</p>
<p>Snowy is not an Image IO library, but for convenience it provides <a href="reference.html#load">load</a> and
<a href="reference.html#export">export</a> functions that have limited support for PNG, EXR, and JPEG.</p>
<p class="aside">If you're interested in tone mapping and other HDR operations, check out the
<a href="https://github.com/tatsy/hydra">hydra</a> module. If you wish to simply load / store raw
floating-point data, consider using npy files instead of image files. The relevant functions are
<a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.load.html">numpy.load</a> and
<a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.save.html">numpy.save</a>.</p>
<h2 id="installing"><a href="#installing">Installing</a></h2>
<p>To install and update snowy, do this:</p>
<p><code>pip3 install -U snowy</code></p>
<h2 id="examples"><a href="#examples">Examples</a></h2>
<h3 id="resize_and_blur"><a href="#resize_and_blur">Resize and blur</a></h3>
<p>This snippet does a resize, then a blur, then horizontally concatenates the two
images.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">snowy</span>

<span class="n">source</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'poodle.png'</span><span class="p">)</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">blurry</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>
<span class="n">snowy</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">snowy</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">source</span><span class="p">,</span> <span class="n">blurry</span><span class="p">]),</span> <span class="s1">'diptych.png'</span><span class="p">)</span>
</pre></div>
<img height="150px" src="diptych.png"/>
<p>The next snippet first magnifies an image using a nearest-neighbor filter, then using the default
Mitchell filter.</p>
<div class="highlight"><pre><span></span><span class="n">parrot</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'parrot.png'</span><span class="p">)</span>
<span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">parrot</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">nearest</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">parrot</span><span class="p">,</span> <span class="n">width</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">snowy</span><span class="o">.</span><span class="n">NEAREST</span><span class="p">)</span> 
<span class="n">mitchell</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">parrot</span><span class="p">,</span> <span class="n">width</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">snowy</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">snowy</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">nearest</span><span class="p">,</span> <span class="n">mitchell</span><span class="p">]))</span>
</pre></div>
<img height="128px" src="diptych-parrot.png"/>
<h3 id="rotate_and_flip"><a href="#rotate_and_flip">Rotate and flip</a></h3>
<div class="highlight"><pre><span></span><span class="n">gibbons</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'gibbons.jpg'</span><span class="p">)</span>
<span class="n">rotated</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">gibbons</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">flipped</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">vflip</span><span class="p">(</span><span class="n">gibbons</span><span class="p">)</span>
<span class="n">triptych</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">gibbons</span><span class="p">,</span> <span class="n">rotated</span><span class="p">,</span> <span class="n">flipped</span><span class="p">],</span>
    <span class="n">border_width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">border_value</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
<img height="150px" src="xforms.png"/>
<h3 id="cropping"><a href="#cropping">Cropping</a></h3>
<p>If you need to crop an image, just use numpy slicing.</p>
<p>For example, this loads an OpenEXR image then crops out the top half:</p>
<div class="highlight"><pre><span></span><span class="n">sunrise</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'sunrise.exr'</span><span class="p">)</span>
<span class="n">cropped_sunrise</span> <span class="o">=</span> <span class="n">sunrise</span><span class="p">[:</span><span class="mi">100</span><span class="p">,:,:]</span>
<span class="n">snowy</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">cropped_sunrise</span> <span class="o">/</span> <span class="mf">50.0</span><span class="p">)</span> <span class="c1"># darken the image</span>
</pre></div>
<img height="100px" src="cropped-sunset.png"/>
<h3 id="alpha_composition"><a href="#alpha_composition">Alpha composition</a></h3>
<p>To copy a section of one image into another, simply use numpy slicing.</p>
<p>However, to achieve "source-over" style alpha blending, using raw numpy math would be cumbersome.
Snowy provides <a href="reference.html#compose">compose</a> to make this easier:</p>
<div class="highlight"><pre><span></span><span class="n">icon</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'snowflake.png'</span><span class="p">)</span>
<span class="n">icon</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">snowflake</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sunset</span><span class="p">[:</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">]</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">sunset</span><span class="p">[:</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">:</span><span class="mi">300</span><span class="p">],</span> <span class="n">icon</span><span class="p">)</span>
<span class="n">snowy</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">sunset</span><span class="p">)</span>
</pre></div>
<img height="100px" src="composed.png"/>
<h3 id="drop_shadows"><a href="#drop_shadows">Drop shadows</a></h3>
<p>Combining operations like <a href="reference.html#blur">blur</a> and <a href="reference.html#compose">compose</a> can be
used to create a drop shadow:</p>
<div class="highlight"><pre><span></span><span class="c1"># Extend the 100x100 snowflake image on 4 sides to give room for blur.</span>
<span class="n">shadow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">shadow</span><span class="p">[</span><span class="mi">25</span><span class="p">:</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">:</span><span class="o">-</span><span class="mi">25</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">icon</span>

<span class="c1"># Invert the colors but not the alpha.</span>
<span class="n">white</span> <span class="o">=</span> <span class="n">shadow</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">white</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">white</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># Blur the shadow, then "strengthen" it.</span>
<span class="n">shadow</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">shadow</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">shadow</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">shadow</span><span class="p">,</span> <span class="n">shadow</span><span class="p">)</span>
<span class="n">shadow</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">shadow</span><span class="p">,</span> <span class="n">shadow</span><span class="p">)</span>
<span class="n">shadow</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">shadow</span><span class="p">,</span> <span class="n">shadow</span><span class="p">)</span>

<span class="c1"># Compose the white flake onto its shadow.</span>
<span class="n">dropshadow</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">shadow</span><span class="p">,</span> <span class="n">white</span><span class="p">)</span>
</pre></div>
<img height="150px" src="dropshadow.png"/>
<h3 id="gradient_noise"><a href="#gradient_noise">Gradient noise</a></h3>
<p>Snowy's <code>generate_noise</code> function generates a single-channel image whose values are
in [-1, +1]. Here we create a square noise image that can be tiled horizontally:</p>
<div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">generate_noise</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">wrapx</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">])</span>
<span class="n">snowy</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
<img height="128px" src="noise.png"/>
<p class="aside">If you're interested in other types of noise, or if you need a super-fast noise generator, you might
want to try <a href="https://github.com/robbmcleod/pyfastnoisesimd">pyfastnoisesimd</a>.</p>
<h3 id="distance_fields"><a href="#distance_fields">Distance fields</a></h3>
<p>This example uses <code>generate_sdf</code> to create a signed distance field from a monochrome picture of two circles
enclosed by a square. Note the usage of <code>unitize</code> to adjust the values into the <code>[0,1]</code> range.</p>
<div class="highlight"><pre><span></span><span class="n">circles</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'circles.png'</span><span class="p">)</span>
<span class="n">sdf</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">unitize</span><span class="p">(</span><span class="n">snowy</span><span class="o">.</span><span class="n">generate_sdf</span><span class="p">(</span><span class="n">circles</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="n">snowy</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">snowy</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">circles</span><span class="p">,</span> <span class="n">sdf</span><span class="p">]))</span>
</pre></div>
<img height="128px" src="sdf.png"/>
<h3 id="image_generation"><a href="#image_generation">Image generation</a></h3>
<p>Combining Snowy's unique features with numpy can be used to create interesting procedural images.
The following example creates an elevation map for an imaginary island.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_falloff</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">cx</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cy</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="n">hw</span><span class="p">,</span> <span class="n">hh</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">w</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">h</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">hw</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">hw</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">hh</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">hh</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">-</span><span class="n">cx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">v</span><span class="o">-</span><span class="n">cy</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="n">snowy</span><span class="o">.</span><span class="n">unitize</span><span class="p">(</span><span class="n">snowy</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">d2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">create_island</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mf">3.5</span><span class="p">):</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">512</span>
    <span class="n">falloff</span> <span class="o">=</span> <span class="n">create_falloff</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="mf">1.000</span> <span class="o">*</span> <span class="n">snowy</span><span class="o">.</span><span class="n">generate_noise</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">freq</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">+</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="mf">0.500</span> <span class="o">*</span> <span class="n">snowy</span><span class="o">.</span><span class="n">generate_noise</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">freq</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">seed</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n3</span> <span class="o">=</span> <span class="mf">0.250</span> <span class="o">*</span> <span class="n">snowy</span><span class="o">.</span><span class="n">generate_noise</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">freq</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">seed</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">n4</span> <span class="o">=</span> <span class="mf">0.125</span> <span class="o">*</span> <span class="n">snowy</span><span class="o">.</span><span class="n">generate_noise</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">freq</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">elevation</span> <span class="o">=</span> <span class="n">falloff</span> <span class="o">*</span> <span class="p">(</span><span class="n">falloff</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">+</span> <span class="n">n3</span> <span class="o">+</span> <span class="n">n4</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">elevation</span> <span class="o">&lt;</span> <span class="mf">0.4</span>
    <span class="n">elevation</span> <span class="o">=</span> <span class="n">snowy</span><span class="o">.</span><span class="n">unitize</span><span class="p">(</span><span class="n">snowy</span><span class="o">.</span><span class="n">generate_sdf</span><span class="p">(</span><span class="n">mask</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mask</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">elevation</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>

<span class="n">snowy</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">create_island</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="s1">'island.png'</span><span class="p">)</span>
</pre></div>
<p><img alt="" src="island.png"/></p>
<p>Snowy also offers the <a href="reference.html#compute_skylight">compute_skylight</a> and
<a href="reference.html#compute_normals">compute_normals</a> functions to help with 3D rendering. These
functions were used to create the following images.</p>
<p><img alt="" src="island_strip.png"/></p>
<p>The first panel shows ambient occlusion generated by <code>compute_skylight</code>, the second panel shows
the normal map generated by <code>compute_normals</code>, the right two panels use numpy to add diffuse
lighting and a color gradient. The code for this is in
<a href="https://github.com/prideout/snowy/blob/master/tests/test_lighting.py">test_lighting.py</a>.</p>
<h2 id="wrap_modes"><a href="#wrap_modes">Wrap modes</a></h2>
<p>Snowy's <a href="reference.html#blur">blur</a>, <a href="reference.html#resize">resize</a>,
<a href="reference.html#generate_noise">generate_noise</a>, and <a href="reference.html#generate_sdf">generate_sdf</a>
functions all take <code>wrapx</code> and <code>wrapy</code> arguments, both of which default to <code>False</code>. These arguments
tell Snowy how to sample from outside the boundaries of the source image or noise function.</p>
<p>To help understand these arguments, consider this tileable image and its 2x2 tiling:</p>
<img height="128px" src="ground.jpg"/>
<br/>
<img height="256px" src="ground2x2.jpg"/>
<p>Next, let's try blurring the tile naively:</p>
<img height="256px" src="blurry_ground2x2_bad.jpg"/>
<p>See the seams? Now let's blur it with <code>wrapx</code> and <code>wrapy</code> set to <code>True</code> when we call
<a href="reference.html#blur">blur</a>:</p>
<img height="256px" src="blurry_ground2x2_good.jpg"/>
<h3 id="wrappable_gradient_noise"><a href="#wrappable_gradient_noise">Wrappable Gradient Noise</a></h3>
<p>The wrap arguments are also useful for 2D noise. One way of making tileable gradient noise is to
sample 3D noise on the surface of a cylinder, torus, or cube. However Snowy can do this more
efficiently by generating 2D noise with modulus arithmetic.</p>
<p>Here we created a 128x256 tile using <a href="reference.html#generate_noise">generate_noise</a> without the
<code>wrapx</code> argument, then horizontally tiled it twice:</p>
<img height="256px" src="tiled_noise_bad.png"/>
<p>Here's another tiling of gradient noise, but this time the tile was generated with <code>wrapx</code> set to
<code>True</code>:</p>
<img height="256px" src="tiled_noise_good.png"/>
<h3 id="wrappable_distance_fields"><a href="#wrappable_distance_fields">Wrappable Distance Fields</a></h3>
<p>Snowy's <a href="reference.html#generate_sdf">generate_sdf</a> function also takes wrap arguments. For example
here's a distance field in a 4x2 tiling:</p>
<img height="128px" src="tiled_sdf_bad.png"/>
<p>Here's the same distance field, this time with wrapx and wrapy set to <code>True</code>:</p>
<img height="128px" src="tiled_sdf_good.png"/>
<h2 id="interop"><a href="#interop">Interop</a></h2>
<p>Snowy's algorithms require images to be row-major three-dimensional <code>float64</code> numpy arrays, with
color channels living in the trailing dimension. If you're working with another module that does not
follow this convention, consider using one of the following interop functions.</p>
<ul>
<li>To add or remove the trailing 1 from the shape of grayscale images, use
<a href="reference.html#reshape">reshape</a> and <a href="reference.html#unshape">unshape</a>.</li>
<li>To swap color channels in or out of the leading dimension, use
<a href="reference.html#to_planar">to_planar</a> and <a href="reference.html#from_planar">from_planar</a>.</li>
<li>To cast between <code>float64</code> and other types, just use numpy. For example,
<code>np.uint8(myimg * 255)</code> or <code>np.float64(myimg) / 255</code>.</li>
<li>To swap rows with columns, use numpy's
<a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.swapaxes.html">swapaxes function</a>.</li>
</ul>
</main>
</head>